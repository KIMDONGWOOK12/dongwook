(()=>{"use strict";var e={10:function(e,t,n){var r,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&o(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.ServerInstallError=void 0,t.parseServerInstallOutput=function(e,t){const n=`${t}: start`,r=`${t}: end`,o=e.indexOf(n);if(o<0)return;const i=e.indexOf(r,o+n.length);if(i<0)return;const s={},a=e.substring(o+n.length,i).split(/\r?\n/);for(const e of a){const[t,n]=e.split("==");s[t]=n}return s},t.generateBashInstallScript=function({id:e,quality:t,vscodeVersion:n,ideVersion:r,commit:o,release:i,extensionIds:s,envVariables:c,useSocketPath:d,serverApplicationName:l,serverDataFolderName:u,distroId:f},h){const g=s.map(e=>"--install-extension "+e).join(" ");return`\n# Server installation script\n\nTMP_DIR="\${XDG_RUNTIME_DIR:-"/tmp"}"\n\nDISTRO_VSCODE_VERSION="${n}"\nDISTRO_IDE_VERSION="${r}"\nDISTRO_COMMIT="${o}"\nDISTRO_ID="${f}"\nDISTRO_QUALITY="${t}"\nDISTRO_VSCODIUM_RELEASE="${i??""}"\n\nSERVER_APP_NAME="${l}"\nSERVER_INITIAL_EXTENSIONS="${g}"\nSERVER_LISTEN_FLAG="${d?`--socket-path="$TMP_DIR/vscode-server-sock-${a.randomUUID()}"`:"--port=0"}"\nSERVER_DATA_DIR="$HOME/${u}"\nSERVER_DIR="$SERVER_DATA_DIR/bin/$DISTRO_IDE_VERSION-$DISTRO_ID"\n# Temporarily remove -insiders suffix from SERVER_APP_NAME to point insider cloudtop to stable\nSERVER_SCRIPT="$SERVER_DIR/bin/$SERVER_APP_NAME"\nSERVER_LOGFILE="$SERVER_DATA_DIR/.$DISTRO_ID.log"\nSERVER_PIDFILE="$SERVER_DATA_DIR/.$DISTRO_ID.pid"\nSERVER_TOKENFILE="$SERVER_DATA_DIR/.$DISTRO_ID.token"\nSERVER_SSH_AGENT_SOCKET="$SERVER_DATA_DIR/.$DISTRO_ID-ssh-auth.sock"\nSERVER_ARCH=\nSERVER_CONNECTION_TOKEN=\nSERVER_DOWNLOAD_URL=\n\nLISTENING_ON=\nOS_RELEASE_ID=\nARCH=\nPLATFORM=\nSERVER_PID=\n\nGLIBC_VERSION_GOOD=\n\n# Add lock mechanism\nLOCK_FILE="$SERVER_DATA_DIR/.installation_lock"\n\n# Function to acquire lock\nacquire_lock() {\n\texec 200>$LOCK_FILE\n\techo "Waiting for lock..."\n\tflock 200\n\techo "Lock acquired, proceeding with installation."\n}\n\n# Function to release lock\nrelease_lock() {\n\tflock -u 200\n\texec 200>&-\n}\n\ntrap release_lock EXIT INT TERM\n\n# Mimic output from logs of remote-ssh extension\nprint_install_results_and_exit() {\n\tif [[ $1 -eq 1 ]]; then\n\t\techo ""\n\t\techo "Error: installation failed."\n\t\tif [[ -f "$SERVER_LOGFILE" ]]; then\n\t\t\techo "Server log:\n $(cat "$SERVER_LOGFILE")\n"\n\t\tfi\n\tfi\n\tif [[ "$GLIBC_VERSION_GOOD" = "false" ]]; then\n\t\techo "Warning: valid glibc version not found. Antigravity only supports remote connections with glibc >= 2.28, such as Ubuntu 20.04, Debian 10, or CentOS 8."\n\t\techo ""\n\tfi\n\techo "${e}: start"\n\techo "exitCode==$1=="\n\techo "listeningOn==$LISTENING_ON=="\n\techo "connectionToken==$SERVER_CONNECTION_TOKEN=="\n\techo "logFile==$SERVER_LOGFILE=="\n\techo "osReleaseId==$OS_RELEASE_ID=="\n\techo "arch==$ARCH=="\n\techo "platform==$PLATFORM=="\n\techo "tmpDir==$TMP_DIR=="\n\t${c.map(e=>`echo "${e}==$${e}=="`).join("\n")}\n\techo "${e}: end"\n\n\texit 0\n}\n\nprint_install_results_and_wait() {\n\t# Check server is indeed running\n\tif [ -f $SERVER_PIDFILE ]; then\n\t\tSERVER_PID="$(cat $SERVER_PIDFILE)"\n\telse\n\t\tprint_install_results_and_exit 1\n\tfi\n\n\techo "${e}: start"\n\t# pretend exit code is 0\n\techo "exitCode=0"\n\techo "listeningOn==$LISTENING_ON=="\n\techo "connectionToken==$SERVER_CONNECTION_TOKEN=="\n\techo "logFile==$SERVER_LOGFILE=="\n\techo "osReleaseId==$OS_RELEASE_ID=="\n\techo "arch==$ARCH=="\n\techo "platform==$PLATFORM=="\n\techo "tmpDir==$TMP_DIR=="\n\t${c.map(e=>`echo "${e}==$${e}=="`).join("\n")}\n\techo "${e}: end"\n\n\trelease_lock\n\n\t# Wait for server to exit\n\twhile ps -p $SERVER_PID >/dev/null 2>&1\n\tdo\n\t\tsleep 10\n\tdone\n}\n\n# Check if platform is supported\nKERNEL="$(uname -s)"\ncase $KERNEL in\n\tDarwin)\n\t\tPLATFORM="darwin"\n\t\t;;\n\tLinux)\n\t\tPLATFORM="linux"\n\t\t;;\n\tFreeBSD)\n\t\tPLATFORM="freebsd"\n\t\t;;\n\tDragonFly)\n\t\tPLATFORM="dragonfly"\n\t\t;;\n\t*)\n\t\techo "Error platform not supported: $KERNEL"\n\t\tprint_install_results_and_exit 1\n\t\t;;\nesac\n\n# Check machine architecture\nARCH="$(uname -m)"\ncase $ARCH in\n\tx86_64 | amd64)\n\t\tSERVER_ARCH="x64"\n\t\t;;\n\tarmv7l | armv8l)\n\t\tSERVER_ARCH="armhf"\n\t\t;;\n\tarm64 | aarch64)\n\t\tSERVER_ARCH="arm64"\n\t\t;;\n\tppc64le)\n\t\tSERVER_ARCH="ppc64le"\n\t\t;;\n\triscv64)\n\t\tSERVER_ARCH="riscv64"\n\t\t;;\n\t*)\n\t\techo "Error architecture not supported: $ARCH"\n\t\tprint_install_results_and_exit 1\n\t\t;;\nesac\n\n# https://www.freedesktop.org/software/systemd/man/os-release.html\nOS_RELEASE_ID="$(grep -i '^ID=' /etc/os-release 2>/dev/null | sed 's/^ID=//gi' | sed 's/"//g')"\nif [ -z $OS_RELEASE_ID ]; then\n\tOS_RELEASE_ID="$(grep -i '^ID=' /usr/lib/os-release 2>/dev/null | sed 's/^ID=//gi' | sed 's/"//g')"\n\tif [ -z $OS_RELEASE_ID ]; then\n\t\tOS_RELEASE_ID="unknown"\n\tfi\nfi\n\n# Create installation folder\nif [ ! -d $SERVER_DIR ]; then\n\tmkdir -p $SERVER_DIR\n\tif (( $? > 0 )); then\n\t\techo "Error creating server install directory"\n\t\tprint_install_results_and_exit 1\n\tfi\nfi\n\n# Acquire lock at the beginning of the script\nacquire_lock\n\n# Add trap to release lock on exit\ntrap release_lock EXIT\n\n\nif [ -n "$SSH_AUTH_SOCK" ]; then\n\tln -s -f $SSH_AUTH_SOCK $SERVER_SSH_AGENT_SOCKET\nfi\nexport SSH_AUTH_SOCK=$SERVER_SSH_AGENT_SOCKET\n\nif [[ "$SERVER_ARCH" == "arm64" ]]; then\n\tSERVER_ARCH="arm"\nfi\nif [[ "$DISTRO_QUALITY" == "insider" ]]; then\n\tSERVER_DOWNLOAD_URL="$DISTRO_QUALITY/$DISTRO_IDE_VERSION-$DISTRO_COMMIT/$PLATFORM-$SERVER_ARCH/Antigravity - Insiders-reh.tar.gz"\nelse\n\tSERVER_DOWNLOAD_URL="$DISTRO_QUALITY/$DISTRO_IDE_VERSION-$DISTRO_COMMIT/$PLATFORM-$SERVER_ARCH/Antigravity-reh.tar.gz"\nfi\n\nif [[ "$PLATFORM" == "linux" ]]; then\n\t# Check ldd version based on format "ldd (.*) 2.28"\n\tversion=$(ldd --version | head -n 1 | grep -oE '[0-9]+.[0-9]+$')\n\tif (( $? > 0 )); then\n\t\techo "Warning: ldd not found"\n\t\tGLIBC_VERSION_GOOD="false"\n\telse\n\t\tmajor=$(echo "$version" | cut -d '.' -f 1)\n\t\tminor=$(echo "$version" | cut -d '.' -f 2)\n\n\t\tif [[ "$major" -eq 2 && "$minor" -ge 28 ]]; then\n\t\t\tGLIBC_VERSION_GOOD="true"\n\t\telse\n\t\t\tGLIBC_VERSION_GOOD="false"\n\t\tfi\n\tfi\n\n\tif [[ "$GLIBC_VERSION_GOOD" = "false" ]]; then\n\t\techo "Warning: valid glibc version not found. Antigravity only supports remote connections with glibc >= 2.28, such as Ubuntu 20.04, Debian 10, or CentOS 8."\n\tfi\nfi\n\n# Check if server script is already installed\nif [ ! -f $SERVER_SCRIPT ]; then\n\tif [ "$PLATFORM" != "darwin" ] && [ "$PLATFORM" != "linux" ]; then\n\t\techo "Error "$PLATFORM" needs manual installation of remote extension host"\n\t\tprint_install_results_and_exit 1\n\tfi\n\n\tpushd $SERVER_DIR > /dev/null\n\n\ttemp_file=$(mktemp)\n\n\tDOWNLOAD_URLS=(\n\t\t"https://edgedl.me.gvt1.com/edgedl/release2/j0qc3/antigravity/$SERVER_DOWNLOAD_URL"\n\t\t"https://redirector.gvt1.com/edgedl/release2/j0qc3/antigravity/$SERVER_DOWNLOAD_URL"\n\t\t"https://edgedl.me.gvt1.com/edgedl/antigravity/$SERVER_DOWNLOAD_URL"\n\t\t"https://redirector.gvt1.com/edgedl/antigravity/$SERVER_DOWNLOAD_URL"\n\t)\n\n\tdownload_success=0\n\tfor url in "\${DOWNLOAD_URLS[@]}"; do\n\t\tif [ ! -z $(which wget) ]; then\n\t\t\twget --tries=3 --timeout=10 --continue --quiet -O $temp_file "$url"\n\t\telse\n\t\t\techo "Error need wget to download server binary"\n\t\t\tprint_install_results_and_exit 1\n\t\tfi\n\n\t\tif (( $? == 0 )); then\n\t\t\tdownload_success=1\n\t\t\tbreak\n\t\telse\n\t\t\techo "Download failed from $url, trying next URL..."\n\t\tfi\n\tdone\n\n\tif (( download_success == 0 )); then\n\t\techo "Error downloading server from all URLs"\n\t\tprint_install_results_and_exit 1\n\tfi\n\n\tmv $temp_file vscode-server.tar.gz\n\n\ttar -xf vscode-server.tar.gz --strip-components 1\n\tif (( $? > 0 )); then\n\t\techo "Error while extracting server contents"\n\t\tprint_install_results_and_exit 1\n\tfi\n\n\tif [ ! -f $SERVER_SCRIPT ]; then\n\t\techo "Error server contents are corrupted"\n\t\tprint_install_results_and_exit 1\n\tfi\n\n\trm -f vscode-server.tar.gz\n\n\tpopd > /dev/null\nelse\n\techo "Server script already installed in $SERVER_SCRIPT"\nfi\n\n# Try to find if server is already running\nif [ -f $SERVER_PIDFILE ]; then\n\tSERVER_PID="$(cat $SERVER_PIDFILE)"\n\tSERVER_RUNNING_PROCESS="$(ps -o pid,args -p $SERVER_PID | grep $SERVER_SCRIPT)"\nelse\n\tSERVER_RUNNING_PROCESS="$(ps -o pid,args -A | grep $SERVER_SCRIPT | grep -v grep)"\n\tif [ -z $SERVER_RUNNING_PROCESS ]; then\n\t\tSERVER_PID=\n\telse\n\t\tSERVER_PID="$(echo $SERVER_RUNNING_PROCESS | cut -d ' ' -f 1 | head -n 1)"\n\tfi\nfi\n\nif [ -z "$SERVER_RUNNING_PROCESS" ]; then\n\tif [ -f "$SERVER_LOGFILE" ]; then\n\t\trm $SERVER_LOGFILE\n\tfi\n\tif [ -f "$SERVER_TOKENFILE" ]; then\n\t\trm $SERVER_TOKENFILE\n\tfi\n\n\ttouch $SERVER_TOKENFILE\n\tchmod 600 $SERVER_TOKENFILE\n\tSERVER_CONNECTION_TOKEN="${h}"\n\techo $SERVER_CONNECTION_TOKEN > $SERVER_TOKENFILE\n\n\texport REMOTE_CONTAINERS=true\n\n\t$SERVER_SCRIPT --start-server --host=127.0.0.1 $SERVER_LISTEN_FLAG $SERVER_INITIAL_EXTENSIONS --connection-token-file $SERVER_TOKENFILE --telemetry-level off --enable-remote-auto-shutdown --accept-server-license-terms &> $SERVER_LOGFILE & disown\n\techo $! > $SERVER_PIDFILE\nelse\n\techo "Server script is already running $SERVER_SCRIPT"\nfi\n\nif [ -f $SERVER_TOKENFILE ]; then\n\tSERVER_CONNECTION_TOKEN="$(cat $SERVER_TOKENFILE)"\nelse\n\techo "Error server token file not found $SERVER_TOKENFILE"\n\tprint_install_results_and_exit 1\nfi\n\nif [ -f "$SERVER_LOGFILE" ]; then\n\tfor i in {1..5}; do\n\t\tLISTENING_ON="$(cat $SERVER_LOGFILE | grep -E 'Extension host agent listening on .+' | sed 's/Extension host agent listening on //')"\n\t\tif [ -n "$LISTENING_ON" ]; then\n\t\t\tbreak\n\t\tfi\n\t\tsleep 0.5\n\tdone\n\n\tif [ -z "$LISTENING_ON" ]; then\n\t\techo "Error server did not start sucessfully"\n\t\tprint_install_results_and_exit 1\n\tfi\nelse\n\techo "Error server log file not found $SERVER_LOGFILE"\n\tprint_install_results_and_exit 1\nfi\n\n# Finish server setup\nprint_install_results_and_exit 0\n`};const a=s(n(982));class c extends Error{constructor(e){super(e)}}t.ServerInstallError=c},15:function(e,t,n){var r,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&o(t,e,n[s]);return i(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.activate=function(e){const t=(0,l.initLogger)(`Remote - Dev Containers (${c.env.appNameShort})`);e.subscriptions.push(t);const n=new u.DevContainerResolver(e,t);e.subscriptions.push(c.workspace.registerRemoteAuthorityResolver(u.DEV_CONTAINER_AUTHORITY,n)),e.subscriptions.push(n);const r=c.commands.registerCommand("antigravity-dev-containers.openInContainer",async()=>{const n=await c.window.showOpenDialog({title:"Select a workspace folder",canSelectMany:!1,defaultUri:c.Uri.file("/"),canSelectFolders:!0});if(!n)return;const r=n[0],o=await c.workspace.findFiles(new c.RelativePattern(r,".devcontainer/**/devcontainer.json"));if(0===o.length)return void c.window.showErrorMessage(`No devcontainer.json files found in the selected folder ${r.fsPath}. Please create a devcontainer.json file in the following path: ${r.fsPath}/.devcontainer/devcontainer.json`);const i=o.map(e=>({label:e.fsPath})),s=await c.window.showQuickPick(i,{title:"Select a devcontainer.json file"});if(!s)return;const a=c.Uri.file(s.label);t.info("Checking docker version runs");try{await(0,d.checkDockerVersion)()}catch(e){return t.show(),void c.window.showErrorMessage(`Error checking Docker version: ${e.message}`)}const l=await(0,d.readDevContainerConfig)({context:e,workspaceFolder:r.fsPath,includeMergedConfig:!1,devcontainerId:void 0,devcontainerPath:a.fsPath});if(!l)return t.show(),void c.window.showErrorMessage("Failed to read devcontainer configuration");const h=f.default.withDevContainerConfig(r.fsPath,a.fsPath);c.commands.executeCommand("vscode.openFolder",c.Uri.from({scheme:"vscode-remote",authority:(0,u.getDevContainerAuthority)(h.toEncodedString()),path:l.workspace.workspaceFolder}),{forceNewWindow:!0})});e.subscriptions.push(r);const o=c.commands.registerCommand("antigravity-dev-containers.reopenInContainer",async n=>{t.show();const r=(e=>{if(!e)return"";const t=c.Uri.parse(e);return t.fsPath.endsWith("devcontainer.json")?t.fsPath:(c.window.showErrorMessage("The selected file is not a devcontainer.json file"),"")})(n)||await(async()=>{const e=await c.workspace.findFiles(".devcontainer/**/devcontainer.json"),t=e.map(e=>({label:e.fsPath,value:e.fsPath}));if(0===t.length)return c.window.showErrorMessage("No devcontainer.json files found"),"";let n,r;if(1===t.length)n=t[0];else{const t=[...e.map(e=>({label:e.fsPath,value:e.fsPath})),{label:"$(folder) Browse...",description:"Select a devcontainer.json file",value:"browse"}];n=await c.window.showQuickPick(t,{placeHolder:"Select the devcontainer.json file"})}if(!n)return"";if("browse"===n.value){const e=await c.window.showOpenDialog({canSelectFiles:!0,canSelectFolders:!1,canSelectMany:!1,filters:{"DevContainer Config":["json"]},title:"Select devcontainer.json file",openLabel:"Select"});if(!e||0===e.length)return"";r=e[0].fsPath}else r=n.value;if(r.endsWith("devcontainer.json"))return r;c.window.showErrorMessage("The selected file is not a devcontainer.json file")})();if(!r)return void c.window.showErrorMessage("No devcontainer.json file selected");const o=(e=>{const t=c.workspace.workspaceFolders;if(t&&0!==t.length)return e?t.find(t=>e.startsWith(t.uri.fsPath)):t[0]})(r);if(!o)return void c.window.showErrorMessage("The selected devcontainer.json must be within a workspace folder");t.info("Checking docker version runs");try{await(0,d.checkDockerVersion)()}catch(e){return t.show(),void c.window.showErrorMessage(`Error checking Docker version: ${e.message}`)}const i=c.Uri.file(r),s=await(0,d.readDevContainerConfig)({context:e,workspaceFolder:o.uri.fsPath,includeMergedConfig:!1,devcontainerId:void 0,devcontainerPath:i.fsPath});if(!s)return t.show(),void c.window.showErrorMessage("Failed to read devcontainer configuration.");const a=f.default.withDevContainerConfig(o.uri.fsPath,i.fsPath);c.commands.executeCommand("vscode.openFolder",c.Uri.from({scheme:"vscode-remote",authority:(0,u.getDevContainerAuthority)(a.toEncodedString()),path:s.workspace.workspaceFolder}))});e.subscriptions.push(o);const i=c.commands.registerCommand("antigravity-dev-containers.attachToRunningContainer",async()=>{t.show(),t.info("Checking docker version runs");try{await(0,d.checkDockerVersion)()}catch(e){return t.show(),void c.window.showErrorMessage(`Error checking Docker version: ${e.message}`)}const e=(await(0,d.executeCommand)('docker ps --format "{{.Names}}\t{{.Image}}"')).stdout.trim();if(!e)return void c.window.showErrorMessage("No running containers found!");const n=e.split("\n").map(e=>{const[t,n]=e.split("\t");return{label:t,description:n}}),r=await c.window.showQuickPick(n,{title:"Select a running container"});if(!r)return;t.info(`Attaching to running container: ${r.label}`);const o=f.default.withContainerId(r.label);c.commands.executeCommand("vscode.newWindow",{remoteAuthority:(0,u.getDevContainerAuthority)(o.toEncodedString())})});e.subscriptions.push(i);const s=c.commands.registerCommand("antigravity-dev-containers.showLog",()=>{t.show()});e.subscriptions.push(s);const a=c.commands.registerCommand("antigravity-dev-containers.reopenFolderLocally",async()=>{try{const e=(()=>{try{for(const e of c.workspace.workspaceFolders||[])return f.default.parseAuthority(e.uri.authority)}catch(e){t.error("Failed to get Dev Container workspace information:",e),t.show()}})();if(!e)return void c.window.showErrorMessage("Failed to get Dev Container workspace information.");if("config"!==e.getType())return void c.window.showErrorMessage("The container is not linked to any local workspace.");await c.commands.executeCommand("workbench.action.remote.close"),await c.commands.executeCommand("vscode.openFolder",c.Uri.file(e.getConfigSetting().workspacePath))}catch(e){t.error("Failed to reopen folder locally:",e),t.show(),c.window.showErrorMessage("Failed to reopen folder locally.")}});e.subscriptions.push(a)};const c=s(n(398)),d=n(435),l=n(60),u=n(454),f=a(n(436))},23:e=>{e.exports=require("util")},60:function(e,t,n){var r,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&o(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.Log=void 0,t.initLogger=function(e){return l instanceof c&&l.dispose(),l=new c(e),l},t.getLogger=function(){return l};const a=s(n(398));class c{output;constructor(e){this.output=a.window.createOutputChannel(e)}data2String(e){return e instanceof Error?e.stack||e.message:!1===e.success&&e.message?e.message:e.toString()}trace(e,t){this.logLevel("Trace",e,t)}info(e,t){this.logLevel("Info",e,t)}error(e,t){this.logLevel("Error",e,t)}raw(e,t){this.output.append(e),t&&this.output.append(this.data2String(t))}logLevel(e,t,n){this.output.appendLine(`[${e}\t- ${this.now()}] ${t}`),n&&this.output.appendLine(this.data2String(n))}now(){const e=new Date;return d(e.getUTCHours()+"",2,"0")+":"+d(e.getMinutes()+"",2,"0")+":"+d(e.getUTCSeconds()+"",2,"0")+"."+e.getMilliseconds()}show(){this.output.show()}dispose(){this.output.dispose()}}function d(e,t,n=" "){return n.repeat(Math.max(0,t-e.length))+e}t.Log=c;let l=new class{trace(e,t){console.log(`[Trace] ${e}`,t||"")}info(e,t){console.log(`[Info] ${e}`,t||"")}error(e,t){console.error(`[Error] ${e}`,t||"")}raw(e,t){console.log(e,t||"")}show(){}dispose(){}}},77:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ROOT_USER=void 0,t.ROOT_USER="root"},278:e=>{e.exports=require("net")},317:e=>{e.exports=require("child_process")},323:function(e,t,n){var r,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&o(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.terminateProcess=function(e,t){if("win32"===process.platform)try{const t={stdio:["pipe","pipe","ignore"]};a.execFileSync("taskkill",["/T","/F","/PID",e.pid.toString()],t)}catch(e){return{success:!1,error:e}}else if("darwin"===process.platform||"linux"===process.platform)try{const n=c.join(t,"scripts","terminateProcess.sh"),r=a.spawnSync(n,[e.pid.toString()]);if(r.error)return{success:!1,error:r.error}}catch(e){return{success:!1,error:e}}else e.kill("SIGKILL");return{success:!0}};const a=s(n(317)),c=s(n(928))},398:e=>{e.exports=require("vscode")},435:function(e,t,n){var r,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&o(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.findRandomPort=function(){return new Promise((e,t)=>{const n=a.createServer({pauseOnConnect:!0});n.on("error",t),n.on("listening",()=>{const t=n.address().port;n.close(()=>e(t))}),n.listen(0,"127.0.0.1")})},t.executeCommand=p,t.findForwarderJSPath=function(){return function(e){const t=function(e,t){const n=e.split(u.sep).reverse();for(const[e,r]of n.entries())if(r===t)return n.slice(e).reverse().join(u.sep)}(__dirname,v);if(void 0!==t)return u.join(t,"scripts",e)}(_)},t.readDevContainerConfig=async function({context:e,workspaceFolder:t,includeMergedConfig:n,devcontainerId:r,devcontainerPath:o}){const i=(0,h.getLogger)();try{if(!r&&!o)return i.error("devcontainerId or devcontainerPath is required"),null;const s=[`"${process.execPath}" "${E(e)}" read-configuration --workspace-folder "${t}"`];n&&s.push("--include-merged-config"),r&&s.push(`--container-id "${r}"`),o&&s.push(`--config "${o}"`);const a=s.join(" ");i.info(`Reading devcontainer configuration with command: ${a}`);const{stdout:c}=await p(a,{...process.env,ELECTRON_RUN_AS_NODE:"1"});return JSON.parse(c)}catch(e){return i.error("Failed to read devcontainer configuration:",e),null}},t.getDevContainerCliPath=E,t.findBestRemoteUser=async function(e,t){if(e.configuration.remoteUser)return e.configuration.remoteUser;if(e.configuration.containerUser)return e.configuration.containerUser;const n=await R(t);if(n)return n;const r=(0,l.userInfo)().username;return await w(r,t)?r:f.ROOT_USER},t.findBestRemoteUserForAttach=async function(e,t){const n=await R(t);if(n)return n;if(e.Config.User)return e.Config.User;const r=(0,l.userInfo)().username;return await w(r,t)?r:f.ROOT_USER},t.checkDockerVersion=async function(){const e=(0,h.getLogger)(),{stdout:t}=await p("docker version");e.info(`Docker version: ${t}`)},t.inspectDockerContainer=async function(e){const t=`docker inspect --type container ${e}`;(0,h.getLogger)().info(`Inspecting Docker container with command: ${t}`);const{stdout:n}=await p(t),r=JSON.parse(n);if(!Array.isArray(r)||0===r.length)throw new Error("Invalid container data: Expected a non-empty array.");return r[0]};const a=s(n(278)),c=n(317),d=n(23),l=n(857),u=s(n(928)),f=n(77),h=n(60),g=(0,d.promisify)(c.exec);async function p(e,t=process.env){const n=(0,h.getLogger)();try{const{stdout:n,stderr:r}=await g(e,{env:t});return{stdout:n,stderr:r}}catch(t){throw n.error(`Error executing command: ${t.message}\nCommand: ${e}`),t.stdout&&n.error(`stdout: ${t.stdout}`),t.stderr&&n.error(`stderr: ${t.stderr}`),new Error(t.message)}}const v="antigravity-dev-containers",_="forwarder.js";function E(e){return process.execArgv.some(e=>"--inspect"===e||"--inspect-brk"===e)?u.join(e.extensionPath,"node_modules","@devcontainers","cli","dist","spec-node","devContainersSpecCLI.js"):u.join(e.extensionPath,"dist","@devcontainers","cli","dist","spec-node","devContainersSpecCLI.js")}async function R(e){try{const{stdout:t}=await p(`docker inspect -f "{{ index .Config.Labels \\"devcontainer.metadata\\" }}" ${e}`);if(t){const e=JSON.parse(t);if(Array.isArray(e))for(const t of e)if(t.remoteUser)return t.remoteUser}return}catch(e){return}}async function w(e,t){const n=`docker exec ${t} bash -c "command -v getent >/dev/null 2>&1 && getent passwd '${e}' || grep -E '^${e}|^[^:]*:[^:]*:${e}:' /etc/passwd || true"`;(0,h.getLogger)().info(`Checking if host user ${e} exists in container ${t}: ${n}`);try{const{stdout:e}=await p(n);return""!==e.trim()}catch(e){return!1}}},436:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n{setting;constructor(e){this.setting=e}static withDevContainerConfig(e,t){return new n({settingType:"config",workspacePath:e,devcontainerPath:t})}static withContainerId(e){return new n({settingType:"container",containerId:e})}static parse(e){const t=e.split("+"),r=t[t.length-1].split("?");return r[1].endsWith(".json")?new n({settingType:"config",workspacePath:r[0],devcontainerPath:r[1]}):new n({settingType:"container",containerId:r[1]})}getType(){return this.setting.settingType}getContainerSetting(){if("container"!==this.setting.settingType)throw new Error("Dev Container is not a container");return this.setting}getConfigSetting(){if("config"!==this.setting.settingType)throw new Error("Dev Container is not a config");return this.setting}static parseJSON(e){const t=JSON.parse(e);if(t.containerId)return new n({settingType:"container",containerId:t.containerId});if(t.workspacePath&&t.devcontainerPath)return new n({settingType:"config",workspacePath:t.workspacePath,devcontainerPath:t.devcontainerPath});throw new Error(`Invalid DevContainerDestination JSON: ${e}`)}toJSON(){const e="config"===this.setting.settingType?{workspacePath:this.setting.workspacePath,devcontainerPath:this.setting.devcontainerPath}:{containerId:this.setting.containerId};return JSON.stringify(e)}static parseAuthority(e){const t=e.split("+");return n.parseEncoded(t[t.length-1])}static parseEncoded(e){try{const t=Buffer.from(e,"hex").toString();return n.parseJSON(t)}catch{}return n.parse(e.replace(/\\x([0-9a-f]{2})/g,(e,t)=>String.fromCharCode(parseInt(t,16))))}toEncodedString(){return Buffer.from(this.toJSON()).toString("hex")}}t.default=n},454:function(e,t,n){var r,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&o(t,e,n[s]);return i(t,e),t}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DevContainerResolver=t.DEV_CONTAINER_AUTHORITY=void 0,t.getDevContainerAuthority=function(e){return`${t.DEV_CONTAINER_AUTHORITY}+${e}`};const c=s(n(398)),d=s(n(982)),l=n(435),u=n(913),f=s(n(10)),h=s(n(928)),g=s(n(857)),p=s(n(896)),v=s(n(317)),_=a(n(436)),E=n(323),R=n(77);t.DEV_CONTAINER_AUTHORITY="dev-container",t.DevContainerResolver=class{context;logger;labelFormatterDisposable;forwarderProcesses=[];constructor(e,t){this.context=e,this.logger=t}resolve(e,t){const n=_.default.parseAuthority(e);this.logger.info(`Resolving dev container authority '${e}' (attempt #${t.resolveAttempt}) container '${n.toJSON()}'`);const r=(0,l.getDevContainerCliPath)(this.context);return c.window.withProgress({location:c.ProgressLocation.Notification,title:"Setting up Dev Container ([details](command:antigravity-dev-containers.showLog))",cancellable:!1},async t=>{let o=!1;return this.logger.info("setup devContainers"),new Promise(async(i,s)=>{t.report({message:`Starting ${c.env.appNameShort} Dev Containers...`}),this.logger.info(`Starting ${c.env.appNameShort} Dev Containers...`);const a=e=>{this.logger.error(e),o||(o=!0,this.logger.show(),c.window.showErrorMessage(e,{modal:!0}).then(()=>{s(c.RemoteAuthorityResolverError.NotAvailable(e,!0))})),s(e)};let v,_=R.ROOT_USER;this.logger.info("Checking docker version runs");try{await(0,l.checkDockerVersion)()}catch(e){return void a(`Failed to check docker version: ${e.message}`)}if("config"===n.getType()){const e=n.getConfigSetting();t.report({message:"Starting Dev Container..."});const[o,i]=await this.startDevContainer(e,r);if(i)return void a(i);if(!o?.containerId)return void a("No container ID found in output");v=o.containerId;const s=await(0,l.readDevContainerConfig)({context:this.context,workspaceFolder:e.workspacePath,includeMergedConfig:!1,devcontainerId:v,devcontainerPath:e.devcontainerPath});if(!s)return void a("Failed to read Dev Container configuration. Please ensure the container exists and the configuration is valid.");this.logger.info("Finished Read Dev Container Configuration."),_=await(0,l.findBestRemoteUser)(s,v)}else{v=n.getContainerSetting().containerId;try{const e=await(0,l.inspectDockerContainer)(v);if("running"!==e.State.Status)return void a(`Failed to start Dev Container: container is not running: ${v}`);_=await(0,l.findBestRemoteUserForAttach)(e,v);const[t,n]=await this.setupDevContainer(v,r);if(n)return void a(n)}catch(e){return void a(`Failed to start Dev Container: container doesn't exist or isn't running: ${e}`)}}this.logger.info(`Remote user: ${_}`),this.logger.info("Installing remote server in container...");let E=String(d.randomInt(0xffffffffff));const w=await(0,u.getVSCodeServerConfig)(),m=d.randomBytes(12).toString("hex"),S={id:m,vscodeVersion:w.vscodeVersion,ideVersion:w.ideVersion,commit:w.commit,quality:w.quality,release:w.release,extensionIds:[],envVariables:[],useSocketPath:!1,serverApplicationName:w.serverApplicationName,serverDataFolderName:w.serverDataFolderName,distroId:w.commit+(w.isDevelopment?"-dev":"")},O=f.generateBashInstallScript(S,E);this.logger.info(`Bash script:\n${O}`),this.logger.info(`Install options: ${JSON.stringify(S,void 0,2)}`);const $=h.join(g.tmpdir(),`${m}.sh`);try{await p.promises.writeFile($,O),await p.promises.chmod($,493)}catch(e){this.logger.error(`Error writing server installation script: ${e}`)}const I=h.posix.join("/tmp",`${m}.sh`),D=`docker cp -a ${$} ${v}:${I}`;let y="",C="";try{({stdout:y,stderr:C}=await(0,l.executeCommand)(D))}catch(e){return void a(`Failed to copy script to container: ${e}`)}if(C)return void a(C);const P=`docker exec -u root ${v} chown ${_}: ${I}`;try{({stdout:y,stderr:C}=await(0,l.executeCommand)(P))}catch(e){return void a(`Failed to change server installation script owner to ${_}: ${e}`)}if(C)return void a(C);const N=`docker exec -u ${_} ${v} chmod +x ${I}`;try{({stdout:y,stderr:C}=await(0,l.executeCommand)(N))}catch(e){return void a(`Failed to change server installation script permissions: ${e}`)}if(C)return void a(C);const T=c.workspace.getConfiguration("remote.antigravityDevContainers").get("enableSSHAgentForwarding")??!0;this.logger.info(`SSH Agent Forwarding: ${T}`);const b=process.env.SSH_AUTH_SOCK,k=h.posix.join("/tmp",`antigravity-remote-ssh-${m}.sock`),L=`docker exec ${T&&b?`-e SSH_AUTH_SOCK=${k}`:""} -u ${_} ${v} bash ${I}`;try{({stdout:y,stderr:C}=await(0,l.executeCommand)(L))}catch(e){return void a(`Failed to install remote server in container: ${e}`)}if(C)return void a(C);this.logger.info("Server install output:",y);const A=y,x=`docker exec -u ${_} ${v} rm ${I}`;try{({stdout:y,stderr:C}=await(0,l.executeCommand)(x))}catch(e){return void a(`Failed to delete script from container: ${e}`)}if(C)return void a(C);if(p.existsSync($))try{await p.promises.rm($)}catch(e){this.logger.info(`Failed to delete temporary script: ${e}`)}this.logger.info(`Finished installing remote server in container. Output: ${A}`);const V=A.match(/connectionToken==(.+)==/);V&&(E=V[1]);const F=A.match(/listeningOn==(\d+)==/),j=A.match(/exitCode==(\d+)==/);if(j&&"1"===j[1])a(`An error occurred while starting the server, with exit code: ${j[1]}\nMore info can be found in the Output tab.`);else if(F){const t=parseInt(F[1]);if(isNaN(t))return void a("Failed to parse server port");const n=`docker inspect -f "{{ .Config.Image }}" ${v}`,{stdout:r}=await(0,l.executeCommand)(n);this.labelFormatterDisposable=c.workspace.registerResourceLabelFormatter({scheme:"vscode-remote",authority:e,formatting:{label:"${path}",separator:"/",tildify:!0,workspaceSuffix:`Container ${r}`}}),c.AntigravityDevContainers.registerAntigravityDevContainerContext({imageName:r,authority:e});const o=this.getRemoteServerNodePath(A,w.ideVersion);if(null===o)return void a("Failed to find RemoteServerPath in output");if(T&&b){const e=await Promise.race([this.forwardSocket(v,b,k,o,_),new Promise(e=>{setTimeout(()=>{e("SSH agent forwarding timed out after 5 seconds")},5e3)})]);""!==e&&this.logger.error(`Failed to forward SSH_AUTH_SOCK: ${e}`)}const[s,d]=await this.forwardPortWithRetry(t,v,o,_);if(""!==d)return void a(d);i(new c.ResolvedAuthority("127.0.0.1",s,E))}else a("Failed to find server port in output")})})}async startDevContainer(e,t){this.logger.info("Start devcontainer up ...");const n=process.execPath,r=v.spawn(n,[t,"up",`--workspace-folder=${e.workspacePath}`,`--config=${e.devcontainerPath}`,"--workspace-mount-consistency=cached","--gpu-availability=detect","--log-level=debug","--log-format=text","--default-user-env-probe=loginInteractiveShell","--update-remote-user-uid-default","--include-configuration","--include-merged-configuration","--skip-post-create"],{env:{...process.env,ELECTRON_RUN_AS_NODE:"1"}});return new Promise(e=>{const t=[];let n=!1;const o=t=>{n||(n=!0,e(t))};r.stdout?.on("data",e=>{t.push(e.toString())}),r.stderr?.on("data",e=>{this.logger.raw(e.toString())}),r.on("error",e=>{this.logger.error("Devcontainer process error:",e),o([null,e.message])}),r.on("close",e=>{if(0!==e)return this.logger.error(`Devcontainer process exited with code ${e}`),void o([null,`Process exited with code ${e}`]);o(this.parseDevContainerOutput(t))})})}parseDevContainerOutput(e){try{const t=e.join(""),n=JSON.parse(t);if(this.logger.info(`Devcontainer output as JSON: ${JSON.stringify(n,null,4)}`),!n||"object"!=typeof n)return[null,"Invalid JSON structure"];const r=n;return"success"!==r.outcome?[r,`Failed to start devcontainer: ${r.message}`]:(this.logger.info(`Found container ID: ${r.containerId}`),[r,""])}catch(e){return this.logger.error("Failed to parse devcontainer output as JSON:",e),[null,"Failed to parse output as JSON"]}}async setupDevContainer(e,t){this.logger.info(`Setup devcontainer on docker container ${e} ...`);const n=process.execPath,r=v.spawn(n,[t,"set-up",`--container-id=${e}`,"--log-level=debug","--log-format=text","--default-user-env-probe=loginInteractiveShell","--include-configuration","--include-merged-configuration","--skip-post-create"],{env:{...process.env,ELECTRON_RUN_AS_NODE:"1"}});return new Promise(e=>{const t=[];let n=!1;const o=t=>{n||(n=!0,e(t))};r.stdout?.on("data",e=>{t.push(e.toString())}),r.stderr?.on("data",e=>{this.logger.raw(e.toString())}),r.on("error",e=>{this.logger.error("Devcontainer process error:",e),o([null,e.message])}),r.on("close",e=>{if(0!==e)return this.logger.error(`Devcontainer process exited with code ${e}`),void o([null,`Process exited with code ${e}`]);o(this.parseDevContainerOutput(t))})})}async forwardPortWithRetry(e,t,n,r,o=3){let i=0,s="";for(;i<o;){const[a,c]=await this.forwardPort(e,t,n,r);if(""===c)return[a,""];s=c,i++,i<o&&(this.logger.info(`Port forwarding attempt ${i} failed, retrying in 1 second...`),await new Promise(e=>setTimeout(e,1e3)))}return[0,`Port forwarding failed after ${o} attempts. Last error: ${s}`]}async forwardPort(e,t,n,r){const o=(0,l.findForwarderJSPath)();if(null===o)return[0,"Failed to find forwarder.js"];const i=process.execPath;this.logger.info(`Forwarding port ${e} for container ${t}`);const s=v.spawn(i,[o,"port",t,n,r,e.toString()],{env:{...process.env,ELECTRON_RUN_AS_NODE:"1"}});return this.forwarderProcesses.push(s),new Promise(e=>{let t="";const n=/====forwarderPort=(\d+)====/;let r,o=!1;const i=t=>{o||(o=!0,e(t))};s.stdout?.on("data",e=>{if(this.logger.info(`forwardPort stdout: ${e}`),void 0===r){t+=e.toString();const o=t.match(n);o&&(r=parseInt(o[1],10),this.logger.info(`Found forwarder port: ${r}`),i([r,""]))}}),s.stderr?.on("data",e=>{this.logger.error(`forwardPort stderr: ${e}`)}),s.on("error",e=>{this.removeForwarderProcess(s),this.logger.error(`forwardPort error: ${e}`),i([0,`failed to forward port: ${e}`])}),s.on("exit",e=>{this.removeForwarderProcess(s),0!==e&&(this.logger.error(`forwardPort exited with code ${e}`),i([0,`failed to forward port, exit code ${e}`]))})})}async forwardSocket(e,t,n,r,o){const i=(0,l.findForwarderJSPath)();if(null===i)return"Failed to find forwarder.js";const s=process.execPath,a=v.spawn(s,[i,"socket",e,r,o,t,n],{env:{...process.env,ELECTRON_RUN_AS_NODE:"1"}});return this.forwarderProcesses.push(a),new Promise(e=>{let t="";const n=/====socketForward=success====/;let r=!1;const o=t=>{r||(r=!0,e(t))};a.stdout?.on("data",e=>{this.logger.info(`forwardSocket stdout: ${e}`),r||(t+=e.toString(),t.match(n)&&o(""))}),a.stderr?.on("data",e=>{this.logger.error(`forwardSocket stderr: ${e}`)}),a.on("error",e=>{this.removeForwarderProcess(a),this.logger.error(`forwardSocket error: ${e}`),o(`failed to forward socket: ${e}`)}),a.on("exit",e=>{this.removeForwarderProcess(a),0!==e&&(this.logger.error(`forwardSocket exited with code ${e}`),o(`failed to forward socket, exit code ${e}`))})})}removeForwarderProcess(e){const t=this.forwarderProcesses.indexOf(e);t>-1&&this.forwarderProcesses.splice(t,1)}getRemoteServerNodePath(e,t){const n=this.getRemoteServerHomeAndCommitHash(e);return null===n?null:`${n.serverHome}/bin/${t}-${n.commitHash}/node`}getRemoteServerHomeAndCommitHash(e){const t=e.match(/logFile==(.+?\/\.[^\/]+)\/\.([a-f0-9]{40}(?:-dev)?)\.log==/);return t?{serverHome:t[1],commitHash:t[2]}:null}async getCanonicalURI(e){return c.Uri.file(e.path)}dispose(){for(const e of this.forwarderProcesses)(0,E.terminateProcess)(e,this.context.extensionPath);this.forwarderProcesses=[],this.logger.dispose(),this.labelFormatterDisposable?.dispose()}}},857:e=>{e.exports=require("os")},896:e=>{e.exports=require("fs")},913:function(e,t,n){var r,o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||(r=function(e){return r=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},r(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=r(e),s=0;s<n.length;s++)"default"!==n[s]&&o(t,e,n[s]);return i(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.getVSCodeServerConfig=async function(){const e=await async function(){if(!l){const e=await c.promises.readFile(d.join(a.env.appRoot,"product.json"),"utf8");l=JSON.parse(e)}return l}(),t=a.workspace.getConfiguration("remote.antigravitySSH.experimental").get("serverBinaryName",""),n=a.version.replace("-insider","");let r=e.ideVersion,o=e.commit,i=e.quality,s=t||e.serverApplicationName,f=e.serverDataFolderName,h=!1;if("dev"===i){const e=await fetch(u),t=await e.json();r=t.ideVersion,o=t.version,i="insider",s="antigravity-server-insiders",f=".antigravity-server-insiders",h=!0}return{vscodeVersion:n,ideVersion:r,commit:o,quality:i,release:e.release,serverApplicationName:s,serverDataFolderName:f,serverDownloadUrlTemplate:e.serverDownloadUrlTemplate,isDevelopment:h}};const a=s(n(398)),c=s(n(896)),d=s(n(928));let l;const u=""},928:e=>{e.exports=require("path")},982:e=>{e.exports=require("crypto")}},t={},n=function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(15),r=exports;for(var o in n)r[o]=n[o];n.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();
//# sourceMappingURL=https://main.vscode-cdn.net/sourcemaps/d2597a5c475647ed306b22de1e39853c7812d07d/extensions/antigravity-dev-containers/dist/extension.js.map